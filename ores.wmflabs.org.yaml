# Top level configuration
ores:
  score_processor: ores_celery
  wsgi:
    application_root: ""
    url_prefix: ""
  data_paths:
    nltk: /srv/ores/data/nltk/

# Score cache options
score_caches:
  ores_redis:
    class: ores.score_caches.Redis
    host: ores-redis
    prefix: "ores"
    socket_timeout: 15

# Metrics collection options
metrics_collectors:
  local_logging:
    class: ores.metrics_collectors.Logger
  wmflabs_statsd:
    class: ores.metrics_collectors.Statsd
    host: labmon1001.eqiad.wmnet
    prefix: ores.{hostname}

# Score processor
score_processors:
  defaults:
    score_cache: ores_redis
    metrics_collector: wmflabs_statsd
    scoring_contexts:
      - enwiki
      - ptwiki
      - fawiki
      - frwiki
      - trwiki
      - eswiki
      #- simplewiki
  ores_celery:
    class: ores.score_processors.Celery
    BROKER_URL: redis://ores-redis
    BROKER_TRANSPORT_OPTIONS: {'socket_timeout': 15} # seconds
    CELERY_RESULT_BACKEND: redis://ores-redis
    CELERY_ACCEPT_CONTENT: ['pickle']
    CELERY_TASK_SERIALIZER: 'pickle'
    CELERY_RESULT_SERIALIZER: 'pickle'
    CELERYD_CONCURRENCY: 16
    timeout: 15 # seconds


# Scorers
scoring_contexts:
  enwiki:
    extractor: enwiki_api
    scorer_models:
      reverted: enwiki_revert
      wp10: enwiki_wp10
  eswiki:
    extractor: eswiki_api
    scorer_models:
      reverted: eswiki_revert
  ptwiki:
    extractor: ptwiki_api
    scorer_models:
      reverted: ptwiki_revert
  fawiki:
    extractor: fawiki_api
    scorer_models:
      reverted: fawiki_revert
  trwiki:
    extractor: trwiki_api
    scorer_models:
      reverted: trwiki_revert
  frwiki:
    extractor: frwiki_api
    scorer_models:
      reverted: frwiki_revert
  simplewiki:
    extractor: simplewiki_api
    scorer_models:
      reverted: simplewiki_revert

# Feature extractors
extractors:
  defaults:
    class: revscoring.extractors.APIExtractor
    user_agent: Object Revision Evaluation Service
    timeout: 5
  enwiki_api:
    host: https://en.wikipedia.org
  eswiki_api:
    host: https://es.wikipedia.org
  ptwiki_api:
    host: https://pt.wikipedia.org
  fawiki_api:
    host: https://fa.wikipedia.org
  trwiki_api:
    host: https://tr.wikipedia.org
  frwiki_api:
    host: https://fr.wikipedia.org

# Scorer models
scorer_models:
  defaults:
    class: revscoring.scorer_models.MLScorerModel
  enwiki_wp10:
    model_file: models/enwiki.wp10.rf.model
  enwiki_revert:
    model_file: models/enwiki.reverted.linear_svc.model
  eswiki_revert:
    model_file: models/eswiki.reverted.linear_svc.model
  ptwiki_revert:
    model_file: models/ptwiki.reverted.linear_svc.model
  frwiki_revert:
    model_file: models/frwiki.reverted.linear_svc.model
  fawiki_revert:
    model_file: models/fawiki.reverted.linear_svc.model
  ptwiki_revert:
    model_file: models/ptwiki.reverted.linear_svc.model
  trwiki_revert:
    model_file: models/trwiki.reverted.linear_svc.model

# Languages
languages:
  english:
    module: revscoring.languages.english
  portuguese:
    module: revscoring.languages.portuguese
  turkish:
    module: revscoring.languages.turkish
  persian:
    module: revscoring.languages.persian
  spanish:
    module: revscoring.languages.spanish
  french:
    module: revscoring.languages.french
